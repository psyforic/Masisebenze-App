<div class="main-content">
    <div class="container-fluid">

        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <button mat-icon-button (click)="backClicked()">
                        <mat-icon>keyboard_backspace</mat-icon>
                    </button> {{client.firstName}} {{client.lastName}}
                </div>
                <div class="header-toolbar">
                    <div class="btn-group" dropdown>
                        <button id="button-basic" dropdownToggle type="button" class="btn btn-primary dropdown-toggle" aria-controls="dropdown-basic">
                            Actions<span class="caret"></span>
                        </button>
                        <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu dropdown-menu-left" role="menu" aria-labelledby="button-basic">
                            <li role="menuitem"><a class="dropdown-item" href="javascript:void(0)" [routerLink]="['/admin/clients/activity-log', client.id]" routerLinkActive="router-link-active">Activity Log</a>
                            </li>
                            <li role="menuitem"><a class="dropdown-item" href="javascript:void(0)" [routerLink]="['/admin/clients/documents/upload', client.id]" routerLinkActive="router-link-active">Upload</a>
                            </li>
                            <li role="menuitem"><a class="dropdown-item" href="javascript:void(0)" [routerLink]="['/admin/comments/clients', client.id]" routerLinkActive="router-link-active">Comments</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <mat-tab-group mat-stretch-tabs (selectedTabChange)="handleTabChange($event)">
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <mat-icon class="example-tab-icon">
                                assignment_ind
                            </mat-icon>
                            Personal Information
                        </ng-template>
                        <div class="col-lg-12">
                            <div class="example-loading-shade" *ngIf="isLoading">
                                <mat-spinner *ngIf="isLoading"></mat-spinner>
                            </div>
                            <form #clientForm="ngForm" (ngSubmit)="save()">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="example-loading-shade" *ngIf="isUploading">
                                            <mat-spinner *ngIf="isUploading"></mat-spinner>
                                        </div>
                                        <div class="card card-profile mt-3">
                                            <div class="card-avatar">
                                                <a href="javascript:void(0)">
                                                    <img class="img" [src]="client.profilePictureId || photoUrl || '../../../../../assets/img/faces/face-0.jpg' " alt="Logo" />
                                                </a>
                                            </div>
                                            <div class="card-body text-center">

                                                <h4 class="text tex-center">{{client.firstName}} {{client.lastName}}
                                                </h4>

                                                <a href="javascript:void(0)" (click)="openCameraModal()" class="btn btn-primary btn-round">
                                                    Change Picture
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <mat-form-field>
                                                            <mat-label>Title</mat-label>
                                                            <mat-select name="title" [(ngModel)]="client.title">
                                                                <mat-option value="Mr.">Mr.</mat-option>
                                                                <mat-option value="Mrs.">Mrs.</mat-option>
                                                                <mat-option value="Ms.">Ms.</mat-option>
                                                                <mat-option value="Mast.">Mast.</mat-option>
                                                                <mat-option value="Dr.">Dr.</mat-option>
                                                                <mat-option value="Prof.">Prof.</mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="First Name" [(ngModel)]="client.firstName" name="firstName">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Last Name" type="text" [(ngModel)]="client.lastName" name="lastName">
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Id Number" type="text" name="idNumber" [(ngModel)]="client.idNumber">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-6">

                                                        <mat-form-field>
                                                            <input matInput #injuryDate="ngModel" (click)="picker.open()" (focus)="picker.open()" [matDatepicker]="picker" id="dateValue" placeholder="Date of Injury" [(ngModel)]="dateOfInjury" name="dateOfInjury" (dateInput)="injuryDateChanged($event)" (dateChange)="setFormTouched(clientForm)"
                                                                readonly>
                                                            <mat-datepicker-toggle matSuffix [for]="picker">
                                                            </mat-datepicker-toggle>
                                                            <mat-datepicker #picker></mat-datepicker>

                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <mat-form-field>
                                                            <input matInput #cDate="ngModel" [matDatepickerFilter]="dateFilter" (click)="courtDatePicker.open()" (focus)="courtDatePicker.open()" [matDatepicker]="courtDatePicker" id="courtDateValue" placeholder="Court Date" [(ngModel)]="courtDate" name="courtDate"
                                                                (dateInput)="courtDateChanged($event)" (dateChange)="setFormTouched(clientForm)" readonly>
                                                            <mat-datepicker-toggle matSuffix [for]="courtDatePicker">
                                                            </mat-datepicker-toggle>
                                                            <mat-datepicker #courtDatePicker></mat-datepicker>

                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <mat-form-field>
                                                            <input matInput (click)="assessmentDatePicker.open()" (focus)="assessmentDatePicker.open()" [matDatepicker]="assessmentDatePicker" placeholder="Assessment Date" [(ngModel)]="assessmentDate" name="assessmentDate" id="assessmentDate" (dateChange)="setFormTouched(clientForm)"
                                                                readonly>
                                                            <mat-datepicker-toggle matSuffix [for]="assessmentDatePicker">
                                                            </mat-datepicker-toggle>
                                                            <mat-datepicker #assessmentDatePicker [disabled]="true">
                                                            </mat-datepicker>

                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Ref Number" type="text" [(ngModel)]="client.caseNumber" name="caseNumber">
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <hr />
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Line 1" type="text" [(ngModel)]="line1" name="line1">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Line 2" type="text" [(ngModel)]="line2" name="line2">
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="City" type="text" [(ngModel)]="city" name="city">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <mat-form-field class="example-full-width">
                                                            <mat-label>Province</mat-label>
                                                            <mat-select [(ngModel)]="province" name="province">
                                                                <mat-option value="Eastern Cape">Eastern Cape
                                                                </mat-option>
                                                                <mat-option value="Free State">Free State</mat-option>
                                                                <mat-option value="Gauteng">Gauteng</mat-option>
                                                                <mat-option value="KwaZulu-Natal">KwaZulu-Natal
                                                                </mat-option>
                                                                <mat-option value="Limpopo">Limpopo</mat-option>
                                                                <mat-option value="Mpumalanga">Mpumalanga</mat-option>
                                                                <mat-option value="Northern Cape">Northern Cape
                                                                </mat-option>
                                                                <mat-option value="North West">North West</mat-option>
                                                                <mat-option value="Western Cape">Western Cape
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <mat-form-field class="example-full-width">
                                                            <input matInput placeholder="Postal Code" type="number" maxlength="8" [(ngModel)]="postalCode" name="postalCode">
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-lg-12">
                                        <mat-accordion>
                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Early ChildHood
                                                    </mat-panel-title>
                                                    <mat-panel-description>
                                                        <!-- Type your name and age -->
                                                    </mat-panel-description>
                                                </mat-expansion-panel-header>
                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.earlyChildhood" [sanitize]="true" name="earlyChildhood">
                                                </quill-editor>
                                            </mat-expansion-panel>
                                            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Family
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.family" [sanitize]="true" name="family">
                                                </quill-editor>
                                            </mat-expansion-panel>

                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Home Environment
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.homeEnvironment" [sanitize]="true" name="homeEnvironment">
                                                </quill-editor>
                                            </mat-expansion-panel>

                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Education
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>

                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.education" [sanitize]="true" name="education">
                                                </quill-editor>
                                            </mat-expansion-panel>

                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Social Habits
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>

                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.socialHabits" [sanitize]="true" name="socialHabits">
                                                </quill-editor>
                                            </mat-expansion-panel>
                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Current complaints
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.currentComplaints" [sanitize]="true" placeholder="Enter Text" name="currentComplaints">
                                                </quill-editor>
                                            </mat-expansion-panel>
                                            <mat-expansion-panel>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        General Appearance
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>

                                                <quill-editor [styles]="{height: '200px'}" [(ngModel)]="client.generalAppearance" [sanitize]="true" name="generalAppearance">
                                                </quill-editor>
                                            </mat-expansion-panel>
                                        </mat-accordion>

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12 mt-3">
                                        <button [disabled]="!clientForm.dirty" mat-raised-button type="submit" color="primary" class="pull-right">
                                            Update Client
                                        </button>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <mat-icon class="example-tab-icon">
                                gavel
                            </mat-icon>
                            Attorney Information
                        </ng-template>
                        <div class="col-lg-12">
                            <div class="example-loading-shade" *ngIf="isLoading">
                                <mat-spinner *ngIf="isLoading"></mat-spinner>
                            </div>
                            <div class="row">
                                <div class="card">
                                    <div class="card-body">
                                        <form #attorneyForm="ngForm" (ngSubmit)="save()">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <mat-form-field class="example-full-width">
                                                        <input matInput placeholder="Law Firm" type="text" name="LawFirm" value="{{client.lawFirm?.companyName}}" readonly>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-6">
                                                    <mat-form-field class="example-full-width">
                                                        <mat-label>Attorney</mat-label>
                                                        <mat-select required [(ngModel)]="client.attorneyId" name="attorney">
                                                            <mat-option *ngFor="let attorney of attorneys" [value]="attorney.id">
                                                                {{attorney.firstName}} {{attorney.lastName}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <mat-form-field class="example-full-width">
                                                        <mat-label>Contact</mat-label>
                                                        <mat-select required [(ngModel)]="client.contactId" name="contact">
                                                            <mat-option *ngFor="let contact of contacts" [value]="contact.id">
                                                                {{contact.firstName}} {{contact.lastName}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-6">
                                                    <button (click)="resendEmail()" type="button" color="primary" class="btn btn-primary btn-round pull-right">
                                                        Resend Email <i class="ml-1 fa fa-envelope-open-o"></i>
                                                    </button>
                                                </div>

                                            </div>
                                        </form>
                                    </div>
                                    <div class="float-right mr-4">
                                        <button [disabled]="!attorneyForm.dirty" mat-raised-button type="submit" color="primary" class="pull-right">
                                            Update
                                        </button>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <mat-icon class="example-tab-icon">
                                folder_shared
                            </mat-icon>
                            Work & Medical History
                        </ng-template>
                        <div class="col-lg-12">

                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <div class="card-title">
                                                <h4>Work history</h4>
                                            </div>
                                        </div>
                                        <form #workHistoryForm="ngForm" (ngSubmit)="updateWorkHistory()">
                                            <div class="card-body">
                                                <mat-accordion>
                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Premorbid
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <app-work-information></app-work-information>
                                                        <quill-editor [styles]="{height: '200px'}" [placeholder]="'Premorbid'" [(ngModel)]="workHistory.premorbid" [sanitize]="true" name="premorbid">
                                                        </quill-editor>

                                                    </mat-expansion-panel>
                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Postmorbid
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [placeholder]="'Premorbid'" [(ngModel)]="workHistory.postMorbid" [sanitize]="true" name="postMorbid">
                                                        </quill-editor>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Work History
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="workHistory.description" [sanitize]="true" name="description">
                                                        </quill-editor>

                                                    </mat-expansion-panel>
                                                    <mat-expansion-panel>
                                                    </mat-expansion-panel>
                                                </mat-accordion>
                                            </div>
                                            <div class="card-footer pull-right">
                                                <div class="row">
                                                    <div class="col-lg-12 mt-3">
                                                        <button mat-raised-button type="submit" color="primary" class="btn-round ">Update
                                                        </button>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <div class="card-title">
                                                <h4 class="text-center">Medical history</h4>
                                            </div>
                                        </div>
                                        <form #medicalHistoryForm="ngForm" (ngSubmit)="updateMedicalHistory()">
                                            <div class="card-body">
                                                <mat-accordion>
                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Previous Injuries
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="medicalHistory.previousInjuries" [sanitize]="true" placeholder="Enter Text" name="previousInjuries">
                                                        </quill-editor>
                                                    </mat-expansion-panel>
                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Medical Conditions
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="medicalHistory.medicalConditions" [sanitize]="true" placeholder="Enter Text" name="medicalConditions">
                                                        </quill-editor>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Current History
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="medicalHistory.currentHistory" [sanitize]="true" placeholder="Enter Text" name="history">
                                                        </quill-editor>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Medication
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="medicalHistory.medication" [sanitize]="true" placeholder="Enter Text" name="medication">
                                                        </quill-editor>
                                                    </mat-expansion-panel>

                                                    <mat-expansion-panel>
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title>
                                                                Clinical observations
                                                            </mat-panel-title>
                                                        </mat-expansion-panel-header>
                                                        <quill-editor [styles]="{height: '200px'}" [(ngModel)]="medicalHistory.clinicalObservation" [sanitize]="true" placeholder="Enter Text" name="clinicalObservation">
                                                        </quill-editor>
                                                    </mat-expansion-panel>
                                                </mat-accordion>
                                            </div>
                                            <div class="card-footer pull-right">
                                                <div class="row">
                                                    <div class="col-lg-12 mt-3">
                                                        <button mat-raised-button type="submit" color="primary" class="btn-round">Update
                                                        </button>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <mat-icon class="example-tab-icon">
                                folder
                            </mat-icon>
                            Documents
                        </ng-template>
                        <div class="col-lg-12">
                            <div class="example-loading-shade" *ngIf="isLoading">
                                <mat-spinner *ngIf="isLoading"></mat-spinner>
                            </div>
                            <div class="row">
                                <div class="card">
                                    <div class="card-body">
                                        <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
                                            <!-- This is the tree node template for leaf nodes -->
                                            <mat-tree-node *matTreeNodeDef="let node;" matTreeNodeToggle>
                                                <li class="mat-tree-node">
                                                    <h6><a href="{{node.url}}" target="_blank"><i
                                                                class="fa fa-file-pdf-o"></i>
                                                            {{node.name}}</a></h6>
                                                </li>

                                                <button color="warn" class="pull-right" (click)="deleteDocument(node)" mat-icon-button>
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                            </mat-tree-node>
                                            <!-- This is the tree node template for expandable nodes -->
                                            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                                                <li>
                                                    <div class="mat-tree-node">
                                                        <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
                                                            <mat-icon class="mat-icon-rtl-mirror">
                                                                {{treeControl.isExpanded(node) ? 'folder_open' : 'folder'}}
                                                            </mat-icon>
                                                        </button> {{node.value}}
                                                    </div>
                                                    <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                                                        <ng-container matTreeNodeOutlet></ng-container>
                                                    </ul>
                                                </li>
                                            </mat-nested-tree-node>
                                        </mat-tree>
                                    </div>
                                </div>
                                <div class="col-lg-12 mt-4" *ngIf="documents.length == 0">
                                    <div class="text-center">
                                        <i class="fa fa-hourglass-3 fa-5x">
                                        </i>
                                        <h4 class="text-center">No Documents Added</h4>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="float-right mr-4">
                                        <button [routerLink]="['/admin/clients/documents/upload', client.id]" type="button" color="primary" class="btn btn-primary btn-round pull-right">
                                            Upload <i class="ml-1 fa fa-upload"></i>
                                        </button>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <mat-icon class="example-tab-icon">
                                assessment
                            </mat-icon>
                            Assessments
                        </ng-template>
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-body text-center text-primary">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <mat-tab-group [selectedIndex]="0" #assessmentTabs mat-stretch-tabs (selectedTabChange)="changeAssessmentTabs($event)">
                                                <mat-tab label="Physical Assessment">

                                                    <div class="example-loading-shade" *ngIf="isLoading">
                                                        <mat-spinner *ngIf="isLoading"></mat-spinner>
                                                    </div>
                                                    <div class="text-center text-dark mt-5" *ngIf="selectedAssessments.length == 0 && !isLoading">
                                                        <i class="fa fa-hourglass-3 fa-5x">
                                                        </i>
                                                        <h4 class="text-center">No Assessments taken</h4>
                                                    </div>
                                                    <div class="text-center text-dark mt-5" *ngIf="selectedAssessments.length == 0 && isLoading">
                                                        <i class="fa fa-hourglass-3 fa-5x">
                                                        </i>
                                                        <h4 class="text-center">Loading assessments ...</h4>
                                                    </div>
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-lg-3" *ngFor="let assessment of selectedAssessments; let i = index">
                                                                <div class="card card-pricing custom-shadow text-center">
                                                                    <h6 class="card-category">
                                                                        {{assessment?.assessmentName}}</h6>
                                                                    <div class="card-body text-center">
                                                                        <p class="card-description">
                                                                            <i class="fa fa-file-text-o fa-5x icon-primary"></i>
                                                                        </p>
                                                                    </div>
                                                                    <div class="card-footer justify-content-center ">
                                                                        <a class="btn btn-round btn-accent" href="javascript:void(0)" (click)="viewPhysicalAssessments(assessment?.assessmentName, assessment?.id)">
                                                                            View
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <app-repetitive-tolerance-protocol #rtp [fullName]="fullName" [clientId]="clientId"></app-repetitive-tolerance-protocol>
                                                </mat-tab>
                                                <mat-tab label="Cognitive Assessment">

                                                    <app-cognitive-assessments #cognitiveAssessments [fullName]="fullName" [categoryId]="categoryId" [clientId]="clientId"></app-cognitive-assessments>
                                                </mat-tab>
                                                <mat-tab label="Functional Assessment">

                                                    <div class="example-loading-shade" *ngIf="isLoading">
                                                        <mat-spinner *ngIf="isLoading"></mat-spinner>
                                                    </div>

                                                    <div class="text-center text-dark mt-5" *ngIf="questionnairesDto.length == 0 && !isLoading">
                                                        <i class="fa fa-hourglass-3 fa-5x">
                                                        </i>
                                                        <h4 class="text-center">No Questionnaires Added</h4>
                                                    </div>
                                                    <div class="text-center text-dark mt-5" *ngIf="questionnairesDto.length == 0 && isLoading">
                                                        <i class="fa fa-hourglass-3 fa-5x">
                                                        </i>
                                                        <h4 class="text-center">Loading assessments ...</h4>
                                                    </div>
                                                    <div class="col-lg-12">
                                                        <div class="row" *ngIf="questionnairesDto.length > 0">
                                                            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12" *ngFor="let questionnaire of questionnaires">
                                                                <div class="card card-pricing custom-shadow text-center">
                                                                    <h6 class="card-category">
                                                                        {{questionnaire.description}}</h6>
                                                                    <div class="card-body text-center">
                                                                        <p class="card-description">
                                                                            <i class="fa fa-file-text-o fa-5x icon-primary"></i>
                                                                        </p>
                                                                    </div>
                                                                    <div class="card-footer justify-content-center">
                                                                        <a class="btn btn-round" [ngClass]="questionnaire.status == 1 ? 'btn-success' : 'btn-accent'" href="javascript:void(0)" 
                                                                            (click)="createQuestionnaire(questionnaire.type, questionnaire.description)">
                                                                            {{questionnaire.status == 1? 'View':'Complete'}}
                                                                        </a>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <button *ngIf="questionnairesDto.length < 4" class="float-right" (click)="addQuestionnaire()" mat-raised-button color="primary">
                                                        <mat-icon>add</mat-icon>
                                                    </button>
                                                </mat-tab>
                                                <mat-tab label="FCE Assessment">
                                                    <mat-progress-bar mode="indeterminate" *ngIf="isLoading" class="my-2"></mat-progress-bar>
                                                    <div class="col-md-12">

                                                        <div class="row mt-2">
                                                            <div class="col-5"></div>
                                                            <div class="col-7">
                                                                <h4 class="text-left"><strong>Job Title: {{jobTitle}}</strong></h4>
                                                            </div>

                                                        </div>
                                                        <div class="row mt-2">
                                                            <div class="col-5"></div>
                                                            <div class="col-7">
                                                                <h4 class="text-left"><strong>Forceful Tasks / Weighted Protocols</strong>
                                                                </h4>
                                                                <div class="text-left text-dark mt-5" *ngIf="weightedProtocolResult.length == 0 && !isLoading">
                                                                    <i class="fa fa-hourglass-3 fa-5x">
                                                                    </i>
                                                                    <h4 class="text-left">No Result</h4>
                                                                </div>
                                                            </div>

                                                        </div>

                                                        <div class="row mnt-5" *ngIf="weightedProtocolTables.length > 0 && !isLoading">
                                                            <div class="col-md-12">
                                                                <table mat-table [dataSource]="weightedProtocolTables">

                                                                    <!--- Note that these columns can be defined in any order.
                                                                          The actual rendered columns are set as a property on the row definition" -->

                                                                    <!-- Position Column -->
                                                                    <ng-container matColumnDef="activity">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Activity</strong>
                                                                        </th>
                                                                        <td class="text-left p-1 fw-500" width="10%" mat-cell *matCellDef="let element">
                                                                            <strong>{{element.activity}}</strong>
                                                                        </td>
                                                                    </ng-container>

                                                                    <!-- Name Column -->
                                                                    <ng-container matColumnDef="result">
                                                                        <th mat-header-cell *matHeaderCellDef class="font-weight-bold">
                                                                            <strong>Result</strong>
                                                                        </th>
                                                                        <td class="text-left p-1" mat-cell width="30%" *matCellDef="let element">
                                                                            {{element.result}}
                                                                        </td>
                                                                    </ng-container>

                                                                    <!-- Weight Column -->
                                                                    <ng-container matColumnDef="onet_description">
                                                                        <th mat-header-cell *matHeaderCellDef class="font-weight-bold">
                                                                            <strong>ONET Description</strong>
                                                                        </th>
                                                                        <td class="text-left p-1" width="30%" mat-cell *matCellDef="let element">
                                                                            {{element.onetDescription}} </td>
                                                                    </ng-container>

                                                                    <!-- Symbol Column -->
                                                                    <ng-container matColumnDef="dot_description">
                                                                        <th mat-header-cell *matHeaderCellDef class="font-weight-bold">
                                                                            <strong>DOT Description</strong>
                                                                        </th>
                                                                        <td class="text-left p-1" width="30%" mat-cell *matCellDef="let element">
                                                                            {{element.dotDescription}} </td>
                                                                    </ng-container>
                                                                    <ng-container matColumnDef="action">
                                                                        <th mat-header-cell *matHeaderCellDef class="font-weight-bold">
                                                                            <strong>Action</strong>
                                                                        </th>
                                                                        <td class="text-left p-1" mat-cell *matCellDef="let element">
                                                                            <mat-icon style="cursor: pointer;" (click)="showComment(element.id, element.activity)">
                                                                                comment</mat-icon>
                                                                    </ng-container>
                                                                    <tr mat-header-row *matHeaderRowDef="weightedProtocolDisplayedColumns">
                                                                    </tr>
                                                                    <tr mat-row *matRowDef="let row; columns: weightedProtocolDisplayedColumns;">
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="row mt-2">
                                                            <div class="col-5"></div>
                                                            <div class="col-7">
                                                                <h4 class="text-left"> <strong>Positional Tolerance Tasks</strong> </h4>
                                                                <div class="text-left text-dark mt-5" *ngIf="positionalToleranceResult.length == 0 && !isLoading">
                                                                    <i class="fa fa-hourglass-3 fa-5x">
                                                                    </i>
                                                                    <h4 class="text-left">No Result</h4>
                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class="row mnt-5" *ngIf="positionalToleranceResult.length > 0 && !isLoading">
                                                            <div class="col-md-12">
                                                                <table mat-table [dataSource]="positionalToleranceResult">

                                                                    <!--- Note that these columns can be defined in any order.
                                                                          The actual rendered columns are set as a property on the row definition" -->

                                                                    <!-- Position Column -->
                                                                    <ng-container matColumnDef="activity">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Activity</strong>
                                                                        </th>
                                                                        <td class="text-left fw-500" mat-cell *matCellDef="let element">
                                                                            <strong> {{element.assessmentName}}</strong>
                                                                        </td>
                                                                    </ng-container>

                                                                    <!-- Name Column -->
                                                                    <ng-container matColumnDef="peformance">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>FCE Performance </strong> </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.result}} </td>
                                                                    </ng-container>

                                                                    <!-- Weight Column -->
                                                                    <ng-container matColumnDef="jobDemand">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Job Demand </strong> </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.jobDemand}} </td>
                                                                    </ng-container>

                                                                    <!-- Symbol Column -->
                                                                    <ng-container matColumnDef="deficit">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Deficit</strong>
                                                                        </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.isDeficit}} </td>
                                                                    </ng-container>

                                                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                    <tr mat-row *matRowDef="let row; columns: displayedColumns;">
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="row mt-2">
                                                            <div class="col-5"></div>
                                                            <div class="col-7">
                                                                <h4 class="text-left"><strong>Repetitive Tolerance Tasks</strong></h4>
                                                                <div class="text-left text-dark mt-5" *ngIf="repetitiveToleranceResult.length == 0 && !isLoading">
                                                                    <i class="fa fa-hourglass-3 fa-5x">
                                                                    </i>
                                                                    <h4 class="text-left">No Result</h4>
                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class="row mnt-5" *ngIf="repetitiveToleranceResult.length > 0 && !isLoading">
                                                            <div class="col-md-12">
                                                                <table mat-table [dataSource]="repetitiveToleranceResult">

                                                                    <!--- Note that these columns can be defined in any order.
                                                                          The actual rendered columns are set as a property on the row definition" -->

                                                                    <!-- Position Column -->
                                                                    <ng-container matColumnDef="activity">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Activity</strong>
                                                                        </th>
                                                                        <td class="text-left fw-500" mat-cell *matCellDef="let element">
                                                                            <strong>{{element.assessmentName}} </strong></td>
                                                                    </ng-container>

                                                                    <!-- Name Column -->
                                                                    <ng-container matColumnDef="peformance">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>FCE Performance</strong> </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.result}} </td>
                                                                    </ng-container>

                                                                    <!-- Weight Column -->
                                                                    <ng-container matColumnDef="jobDemand">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Job Demand</strong> </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.jobDemand}} </td>
                                                                    </ng-container>

                                                                    <!-- Symbol Column -->
                                                                    <ng-container matColumnDef="deficit">
                                                                        <th mat-header-cell *matHeaderCellDef>
                                                                            <strong>Deficit</strong>
                                                                        </th>
                                                                        <td class="text-left" mat-cell *matCellDef="let element">
                                                                            {{element.isDeficit}} </td>
                                                                    </ng-container>

                                                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                    <tr mat-row *matRowDef="let row; columns: displayedColumns;">
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="row"> -->
                                                    <div class="col-lg-12">
                                                        <!-- <mat-accordion> -->
                                                        <!-- <mat-expansion-panel>
                                                                    <mat-expansion-panel-header>
                                                                        <mat-panel-title>
                                                                            Report Summary
                                                                        </mat-panel-title>
                                                                    </mat-expansion-panel-header>
                                                                    <div class="col-md-12"> -->
                                                        <app-report-summary></app-report-summary>
                                                        <!-- </div>
                                                                </mat-expansion-panel> -->
                                                        <!-- </mat-accordion> -->
                                                    </div>
                                                    <!-- </div> -->
                                                </mat-tab>
                                            </mat-tab-group>
                                        </div>

                                    </div>
                                </div>

                            </div>

                        </div>
                    </mat-tab>
                </mat-tab-group>
            </div>
        </div>
    </div>
</div>
<app-camera-modal #newPhoto (pictureUpload)="upload($event)"></app-camera-modal>
<app-grip-strength #gripStrength [clientId]="clientId" [age]="getAge()" [fullName]="fullName" [gender]="getGender()">
</app-grip-strength>
<app-gait #gait [fullName]="fullName" [clientId]="clientId"></app-gait>
<app-muscle-power #musclePower [clientId]="clientId" [fullName]="fullName"></app-muscle-power>
<app-range-of-motion #rangeOfMotion [fullName]="fullName" [clientId]="clientId"></app-range-of-motion>
<app-borg-balance #borgBalance [clientId]="clientId" [fullName]="fullName"></app-borg-balance>
<app-sensation #sensation [fullName]="fullName" [clientId]="clientId"></app-sensation>
<app-coordination #coordination [fullName]="fullName" [clientId]="clientId"></app-coordination>
<app-posture #posture [fullName]="fullName" [clientId]="clientId"></app-posture>
<app-affect #affect [fullName]="fullName" [clientId]="clientId"></app-affect>
<app-mobility #mobility [fullName]="fullName" [clientId]="clientId"></app-mobility>
<app-functional-assessment #functional [fullName]="fullName" [clientId]="clientId" (assessmentsAdded)="loadList()"></app-functional-assessment>
<app-questionnaire #questionnaire [fullName]="fullName" [clientId]="clientId" [type]="questionnaireType" [description]="questionnaireDescription"></app-questionnaire>
